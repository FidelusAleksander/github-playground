name: AWS Integration Request

on:
  issues:
    labels: [aws-integration-request]

jobs:
  process:
    name: Process AWS Integration Request
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      - name: Issue Forms Body Parser
        id: parse-issue
        uses: zentered/issue-forms-body-parser@v2.2.0
      - run: |
          cd infra
          jq --arg id "$NEW_ACCOUNT_ID" '.account_ids += [$id]' config.json > temp.json && mv temp.json config.json
          cat config.json
        env:
          NEW_ACCOUNT_ID: ${{ steps.parse-issue.outputs.data.aws-account-id }}
